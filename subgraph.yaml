specVersion: 1.2.0
indexerHints:
  prune: auto
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: VaultFactory
    network: sonic-mainnet
    source:
      address: "0xA988271170293886868C06981b106b9beB96e450"
      abi: VaultFactory
      startBlock: 46139232
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - FactoryShutdown
        - GovernanceTransferred
        - NewVault
        - RemovedCustomProtocolFee
        - UpdateCustomProtocolFee
        - UpdatePendingGovernance
        - UpdateProtocolFeeBps
        - UpdateProtocolFeeRecipient
      abis:
        - name: VaultFactory
          file: ./abis/VaultFactory.json
        - name: VaultV3
          file: ./abis/VaultV3.json
        - name: ITokenizedStrategy
          file: ./abis/ITokenizedStrategy.json
      eventHandlers:
        - event: FactoryShutdown()
          handler: handleFactoryShutdown
        - event: GovernanceTransferred(indexed address,indexed address)
          handler: handleGovernanceTransferred
        - event: NewVault(indexed address,indexed address)
          handler: handleNewVault
        - event: RemovedCustomProtocolFee(indexed address)
          handler: handleRemovedCustomProtocolFee
        - event: UpdateCustomProtocolFee(indexed address,uint16)
          handler: handleUpdateCustomProtocolFee
        - event: UpdatePendingGovernance(indexed address)
          handler: handleUpdatePendingGovernance
        - event: UpdateProtocolFeeBps(uint16,uint16)
          handler: handleUpdateProtocolFeeBps
        - event: UpdateProtocolFeeRecipient(indexed address,indexed address)
          handler: handleUpdateProtocolFeeRecipient
      file: ./src/mappings/vault-factory.ts
  - kind: ethereum
    name: StrategyFactory
    network: sonic-mainnet
    source:
      address: "0xB6506994412c82a4D9A01aa9309F0b32f9e62bde"
      abi: StrategyFactory
      startBlock: 46413564
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - NewStrategy
      abis:
        - name: StrategyFactory
          file: ./abis/StrategyFactory.json
      eventHandlers:
        - event: NewStrategy(indexed address,indexed address)
          handler: handleNewStrategy
      file: ./src/mappings/strategy-factory.ts
templates:
  - kind: ethereum
    name: VaultV3
    network: sonic-mainnet
    source:
      abi: VaultV3
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Deposit
        - Withdraw
        - Transfer
        - Approval
        - StrategyChanged
        - StrategyReported
        - DebtUpdated
        - RoleSet
        - UpdateFutureRoleManager
        - UpdateRoleManager
        - UpdateAccountant
        - UpdateDepositLimitModule
        - UpdateWithdrawLimitModule
        - UpdateDefaultQueue
        - UpdateUseDefaultQueue
        - UpdateAutoAllocate
        - UpdatedMaxDebtForStrategy
        - UpdateDepositLimit
        - UpdateMinimumTotalIdle
        - UpdateProfitMaxUnlockTime
        - DebtPurchased
        - Shutdown
      abis:
        - name: VaultV3
          file: ./abis/VaultV3.json
        - name: ITokenizedStrategy
          file: ./abis/ITokenizedStrategy.json
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdraw(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleWithdraw
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
        - event: Approval(indexed address,indexed address,uint256)
          handler: handleApproval
        - event: StrategyChanged(indexed address,indexed uint256)
          handler: handleStrategyChanged
        - event: StrategyReported(indexed address,uint256,uint256,uint256,uint256,uint256,uint256)
          handler: handleStrategyReported
        - event: DebtUpdated(indexed address,uint256,uint256)
          handler: handleDebtUpdated
        - event: RoleSet(indexed address,indexed uint256)
          handler: handleRoleSet
        - event: UpdateFutureRoleManager(indexed address)
          handler: handleUpdateFutureRoleManager
        - event: UpdateRoleManager(indexed address)
          handler: handleUpdateRoleManager
        - event: UpdateAccountant(indexed address)
          handler: handleUpdateAccountant
        - event: UpdateDepositLimitModule(indexed address)
          handler: handleUpdateDepositLimitModule
        - event: UpdateWithdrawLimitModule(indexed address)
          handler: handleUpdateWithdrawLimitModule
        - event: UpdateDefaultQueue(address[])
          handler: handleUpdateDefaultQueue
        - event: UpdateUseDefaultQueue(bool)
          handler: handleUpdateUseDefaultQueue
        - event: UpdateAutoAllocate(bool)
          handler: handleUpdateAutoAllocate
        - event: UpdatedMaxDebtForStrategy(indexed address,indexed address,uint256)
          handler: handleUpdatedMaxDebtForStrategy
        - event: UpdateDepositLimit(uint256)
          handler: handleUpdateDepositLimit
        - event: UpdateMinimumTotalIdle(uint256)
          handler: handleUpdateMinimumTotalIdle
        - event: UpdateProfitMaxUnlockTime(uint256)
          handler: handleUpdateProfitMaxUnlockTime
        - event: DebtPurchased(indexed address,uint256)
          handler: handleDebtPurchased
        - event: Shutdown()
          handler: handleShutdown
      file: ./src/mappings/vault-v3.ts
